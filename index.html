<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Hindi/Urdu TTS Studio</title>
<style>
:root { --primary: #0ea5e9; --bg: #0f172a; --card: #1e293b; --text: #e2e8f0; --border: #334155; }
* { box-sizing: border-box; }
body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; min-height: 100vh; }
header { padding: 18px; text-align: center; font-size: 1.4rem; font-weight: 700; background: #020617; border-bottom: 2px solid var(--primary); box-shadow: 0 4px 15px rgba(0,0,0,0.3); letter-spacing: 1px; }
.container { padding: 20px; max-width: 600px; margin: 0 auto; width: 100%; flex: 1; }
label { display: block; margin: 15px 0 8px; color: var(--primary); font-size: 0.95rem; font-weight: 600; }
select, textarea, input[type="text"] { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border); background: var(--card); color: #fff; font-size: 1rem; outline: none; transition: 0.3s; }
select:focus, textarea:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(14, 165, 233, 0.2); }
textarea { min-height: 180px; resize: vertical; line-height: 1.6; }
.slider-group { display: flex; gap: 20px; margin-top: 15px; }
.slider-box { flex: 1; background: var(--card); padding: 10px; border-radius: 10px; border: 1px solid var(--border); }
.slider-label { font-size: 0.8rem; color: #94a3b8; margin-bottom: 5px; display: flex; justify-content: space-between; }
input[type=range] { width: 100%; accent-color: var(--primary); cursor: pointer; }
.buttons { display: flex; gap: 12px; margin-top: 25px; }
button { flex: 1; padding: 16px; border-radius: 12px; border: none; font-size: 1rem; font-weight: 700; cursor: pointer; transition: transform 0.2s, opacity 0.2s; text-transform: uppercase; letter-spacing: 0.5px; }
button.primary { background: linear-gradient(135deg, #0ea5e9, #2563eb); color: white; box-shadow: 0 4px 10px rgba(14, 165, 233, 0.4); }
button.secondary { background: var(--card); color: #cbd5e1; border: 1px solid var(--border); }
button:active { transform: scale(0.98); }
button:disabled { opacity: 0.6; cursor: not-allowed; }
#status-box { margin-top: 20px; padding: 12px; background: #334155; border-radius: 8px; text-align: center; font-size: 0.9rem; display: none; }
audio { width: 100%; margin-top: 25px; display: none; border-radius: 50px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
.download-btn { background: #22c55e; color: white; width: 100%; margin-top: 15px; padding: 14px; border: none; border-radius: 12px; font-size: 1rem; font-weight: bold; cursor: pointer; display: none; }
.char-count { text-align: right; font-size: 0.8rem; color: #64748b; margin-top: 5px; }
</style>
</head>
<body>

<header>üéôÔ∏è Hindi/Urdu AI Studio</header>

<div class="container">

<label>API URL (Auto-Detected)</label>
<input id="api-url" value="https://hindi-tts-3gjy.onrender.com" readonly style="opacity:0.6; font-size:0.8rem; padding:10px;">

<label>üó£Ô∏è ‡§Ü‡§µ‡§æ‡•õ ‡§ö‡•Å‡§®‡•á‡§Ç (Select Voice)</label>
<select id="voice">
  <optgroup label="üáÆüá≥ HINDI (India)">
    <option value="hi-male" selected>Male 1: Madhur (Professional/Heavy)</option>
    <option value="hi-female">Female 1: Swara (News Anchor/Standard)</option>
    <option value="hi-female-2">Female 2: Noopur (Fast/Sharp Tone)</option>
  </optgroup>
  
  <optgroup label="üáµüá∞ URDU (Pakistan)">
    <option value="ur-pk-male">Male: Asad (Best for Poetry/Heavy)</option>
    <option value="ur-pk-female">Female: Uzma (Storytelling/Soft)</option>
  </optgroup>

  <optgroup label="üáÆüá≥ URDU (India)">
    <option value="ur-male">Male: Salman (Casual Conversation)</option>
    <option value="ur-female">Female: Gulshan (Indian Shayari Style)</option>
  </optgroup>
</select>

<!-- Slider Controls -->
<div class="slider-group">
    <div class="slider-box">
        <div class="slider-label"><span>Speed (‡§ó‡§§‡§ø)</span> <span id="rate-val">Normal</span></div>
        <input type="range" id="rate" min="-50" max="50" value="0" oninput="updateLabels()">
    </div>
    <div class="slider-box">
        <div class="slider-label"><span>Pitch (‡§Ü‡§µ‡§æ‡•õ)</span> <span id="pitch-val">Normal</span></div>
        <input type="range" id="pitch" min="-20" max="20" value="0" oninput="updateLabels()">
    </div>
</div>

<label>üìù ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç (Hindi / Urdu)</label>
<textarea id="text" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç... 
(Max Limit: 2500 Characters)" oninput="updateCount()"></textarea>
<div class="char-count" id="char-count">0 / 2500</div>

<div class="buttons">
    <button class="primary" id="genBtn" onclick="generate()">‚ñ∂ Generate</button>
    <button class="secondary" onclick="stopAudio()">‚èπ Stop</button>
</div>

<div id="status-box">Processing...</div>

<audio id="player" controls></audio>
<button id="dlBtn" class="download-btn" onclick="download()">‚¨á Download MP3</button>

</div>

<script>
let audioBlob = null;
const audioPlayer = document.getElementById("player");
const genBtn = document.getElementById("genBtn");
const statusBox = document.getElementById("status-box");
const dlBtn = document.getElementById("dlBtn");

function updateCount() {
    const len = document.getElementById("text").value.length;
    document.getElementById("char-count").innerText = len + " / 2500";
    if(len > 2500) document.getElementById("char-count").style.color = "#ef4444";
    else document.getElementById("char-count").style.color = "#64748b";
}

function updateLabels() {
    const r = document.getElementById("rate").value;
    const p = document.getElementById("pitch").value;
    document.getElementById("rate-val").innerText = r == 0 ? "Normal" : (r > 0 ? "+" + r + "%" : r + "%");
    document.getElementById("pitch-val").innerText = p == 0 ? "Normal" : (p > 0 ? "+" + p + "Hz" : p + "Hz");
}

async function generate(){
  const text = document.getElementById("text").value.trim();
  const voice = document.getElementById("voice").value;
  const rate = document.getElementById("rate").value;
  const pitch = document.getElementById("pitch").value;
  
  const baseUrl = document.getElementById("api-url").value.replace(/\/$/, "");
  const API_URL = baseUrl + "/tts";

  if(!text){ alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç!"); return; }
  if(text.length > 5000){ alert("‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡§π‡•Å‡§§ ‡§≤‡§Ç‡§¨‡§æ ‡§π‡•à, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§"); return; }

  genBtn.disabled = true;
  genBtn.innerText = "Generating...";
  genBtn.style.opacity = "0.7";
  
  statusBox.style.display = "block";
  statusBox.innerText = "‚òÅÔ∏è Creating Audio...";
  statusBox.style.color = "#ffd700";
  statusBox.style.background = "#334155";
  
  audioPlayer.style.display = "none";
  dlBtn.style.display = "none";

  try {
    const res = await fetch(API_URL, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ text, voice, rate, pitch })
    });

    if(!res.ok) {
        const errData = await res.json();
        throw new Error(errData.detail || errData.error || "Server Error");
    }

    audioBlob = await res.blob();
    const url = URL.createObjectURL(audioBlob);
    
    audioPlayer.src = url;
    audioPlayer.style.display = "block";
    dlBtn.style.display = "block";
    statusBox.style.display = "none";
    
    try { await audioPlayer.play(); } catch(e){}

  } catch(e) {
    statusBox.innerText = "‚ùå Error: " + e.message;
    statusBox.style.color = "#ff4d4d";
    statusBox.style.background = "#450a0a";
  } finally {
    genBtn.disabled = false;
    genBtn.innerText = "‚ñ∂ Generate";
    genBtn.style.opacity = "1";
  }
}

function stopAudio(){
  audioPlayer.pause();
  audioPlayer.currentTime = 0;
}

function download(){
  if(!audioBlob) return;
  const a = document.createElement("a");
  a.href = URL.createObjectURL(audioBlob);
  a.download = "hindi-urdu-tts.mp3";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>

</body>
</html>
