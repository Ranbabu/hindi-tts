<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Hindi/Urdu Voices TTS</title>
<!-- Google Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
<style>
:root { --primary: #0ea5e9; --bg: #0f172a; --card: #1e293b; --text: #e2e8f0; --border: #334155; }
* { box-sizing: border-box; }
body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; min-height: 100vh; }

header {
    padding: 16px; text-align: center; font-size: 1.3rem; font-weight: 700;
    background: #020617; border-bottom: 2px solid var(--primary);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3); letter-spacing: 0.5px;
    display: flex; align-items: center; justify-content: center; gap: 10px;
}

.container { padding: 20px; max-width: 650px; margin: 0 auto; width: 100%; flex: 1; }

label { display: block; margin: 15px 0 8px; color: var(--primary); font-size: 0.95rem; font-weight: 600; }

/* Voice Selection */
.voice-row { display: flex; gap: 10px; align-items: center; }
select {
    flex: 1; padding: 14px; border-radius: 12px; border: 1px solid var(--border);
    background: var(--card); color: #fff; font-size: 1rem; outline: none;
}
.test-btn {
    padding: 14px; background: #eab308; color: #000; border: none; border-radius: 12px;
    font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 5px;
}
.test-btn:active { transform: scale(0.95); }

/* Sliders */
.slider-header { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; }
.reset-btn {
    background: transparent; border: 1px solid #ef4444; color: #ef4444;
    padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; cursor: pointer;
}
.slider-group { display: flex; gap: 15px; margin-top: 5px; }
.slider-box { flex: 1; background: var(--card); padding: 12px; border-radius: 12px; border: 1px solid var(--border); }
.slider-label { font-size: 0.8rem; color: #94a3b8; margin-bottom: 8px; display: flex; justify-content: space-between; }
input[type=range] { width: 100%; accent-color: var(--primary); cursor: pointer; }

/* Text Area */
.text-wrapper { position: relative; margin-top: 5px; }
textarea {
    width: 100%; padding: 16px; padding-right: 40px; border-radius: 12px;
    border: 1px solid var(--border); background: var(--card); color: #fff;
    font-size: 1.05rem; outline: none; min-height: 200px; resize: vertical; line-height: 1.6;
}
textarea:focus { border-color: var(--primary); }
.clear-icon {
    position: absolute; top: 12px; right: 12px; color: #64748b; cursor: pointer;
    background: rgba(30, 41, 59, 0.8); border-radius: 50%; padding: 4px;
}
.clear-icon:hover { color: #ef4444; background: #334155; }

.char-count { text-align: right; font-size: 0.8rem; color: #64748b; margin-top: 5px; }

/* Buttons */
.buttons { display: flex; gap: 12px; margin-top: 25px; }
button.main-btn {
    flex: 1; padding: 16px; border-radius: 12px; border: none; font-size: 1rem;
    font-weight: 700; cursor: pointer; text-transform: uppercase;
    transition: transform 0.2s; display: flex; justify-content: center; align-items: center; gap: 8px;
}
.btn-gen { background: linear-gradient(135deg, #0ea5e9, #2563eb); color: white; }
.btn-stop { background: var(--card); color: #cbd5e1; border: 1px solid var(--border); flex: 0.4; }
button:active { transform: scale(0.98); }
button:disabled { opacity: 0.6; cursor: not-allowed; }

#status-box { margin-top: 20px; padding: 12px; background: #334155; border-radius: 8px; text-align: center; font-size: 0.9rem; display: none; }
audio { width: 100%; margin-top: 25px; display: none; border-radius: 50px; }
.download-btn { background: #22c55e; color: white; width: 100%; margin-top: 15px; padding: 14px; border: none; border-radius: 12px; font-size: 1rem; font-weight: bold; cursor: pointer; display: none; }
</style>
</head>
<body>

<header>
    <span class="material-icons-round">record_voice_over</span> 
    All Voice Studio
</header>

<div class="container">

<label>API URL</label>
<input id="api-url" value="https://hindi-tts-3gjy.onrender.com" readonly style="opacity:0.6; font-size:0.8rem; padding:10px; border-radius:8px;">

<!-- All Voices Dropdown -->
<label>üó£Ô∏è ‡§Ü‡§µ‡§æ‡•õ ‡§ö‡•Å‡§®‡•á‡§Ç (Total 9 Voices)</label>
<div class="voice-row">
    <select id="voice">
        <optgroup label="üáÆüá≥ Hindi (India)">
            <option value="hi-male" selected>Male 1: Madhur (Deep/Professional)</option>
            <option value="hi-female">Female 1: Swara (News/Standard)</option>
            <option value="hi-female-2">Female 2: Noopur (Sharp/Fast) *Experimental</option>
        </optgroup>
        
        <optgroup label="üáµüá∞ Urdu (Pakistan)">
            <option value="ur-pk-male">Male: Asad (Heavy/Poetic/Ghazal)</option>
            <option value="ur-pk-female">Female: Uzma (Story/Soft)</option>
        </optgroup>

        <optgroup label="üáÆüá≥ Urdu (India)">
            <option value="ur-male">Male: Salman (Casual Conversation)</option>
            <option value="ur-female">Female: Gulshan (Indian Shayari) *Experimental</option>
        </optgroup>

        <optgroup label="üáÆüá≥ Hinglish (Indian Accent English)">
            <option value="en-in-female">Female: Neerja (English Accent)</option>
            <option value="en-in-male">Male: Prabhat (English Accent)</option>
        </optgroup>
    </select>
    <button class="test-btn" onclick="testVoice()" title="Play Sample">
        <span class="material-icons-round">play_circle</span> Test
    </button>
</div>

<!-- Sliders -->
<div class="slider-header">
    <label style="margin:0">üéöÔ∏è Audio Controls</label>
    <button class="reset-btn" onclick="resetSliders()">‚Ü∫ Reset</button>
</div>
<div class="slider-group">
    <div class="slider-box">
        <div class="slider-label"><span>Speed</span> <span id="rate-val">Normal</span></div>
        <input type="range" id="rate" min="-50" max="50" value="0" oninput="updateLabels()">
    </div>
    <div class="slider-box">
        <div class="slider-label"><span>Pitch</span> <span id="pitch-val">Normal</span></div>
        <input type="range" id="pitch" min="-20" max="20" value="0" oninput="updateLabels()">
    </div>
</div>

<!-- Text Area -->
<label>üìù ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç (Max 4000)</label>
<div class="text-wrapper">
    <textarea id="text" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç...&#10;For Bhojpuri: Use Hindi Male (Madhur).&#10;For Hinglish: Use Neerja or Prabhat." oninput="updateCount()"></textarea>
    <span class="material-icons-round clear-icon" onclick="clearText()" title="Clear Text">delete_outline</span>
</div>
<div class="char-count" id="char-count">0 / 4000</div>

<!-- Buttons -->
<div class="buttons">
    <button class="main-btn btn-gen" id="genBtn" onclick="generate()">
        <span class="material-icons-round">multitrack_audio</span> Generate
    </button>
    <button class="main-btn btn-stop" onclick="stopAudio()">
        <span class="material-icons-round">stop</span>
    </button>
</div>

<div id="status-box">Processing...</div>
<audio id="player" controls></audio>
<button id="dlBtn" class="download-btn" onclick="download()">‚¨á Download MP3</button>

</div>

<script>
let audioBlob = null;
const audioPlayer = document.getElementById("player");
const genBtn = document.getElementById("genBtn");
const statusBox = document.getElementById("status-box");
const dlBtn = document.getElementById("dlBtn");
const apiInput = document.getElementById("api-url");

function updateCount() {
    const len = document.getElementById("text").value.length;
    document.getElementById("char-count").innerText = len + " / 4000";
    if(len > 4000) document.getElementById("char-count").style.color = "#ef4444";
    else document.getElementById("char-count").style.color = "#64748b";
}

function updateLabels() {
    const r = document.getElementById("rate").value;
    const p = document.getElementById("pitch").value;
    document.getElementById("rate-val").innerText = r == 0 ? "Normal" : (r > 0 ? "+" + r + "%" : r + "%");
    document.getElementById("pitch-val").innerText = p == 0 ? "Normal" : (p > 0 ? "+" + p + "Hz" : p + "Hz");
}

function resetSliders() {
    document.getElementById("rate").value = 0;
    document.getElementById("pitch").value = 0;
    updateLabels();
}

function clearText() {
    if(document.getElementById("text").value && confirm("Clear text?")) {
        document.getElementById("text").value = "";
        updateCount();
    }
}

async function testVoice() {
    const voice = document.getElementById("voice").value;
    let testText = "‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§Ø‡§π ‡§è‡§ï ‡§µ‡•â‡§Ø‡§∏ ‡§ü‡•á‡§∏‡•ç‡§ü ‡§π‡•à‡•§";
    if(voice.includes("ur")) testText = "‡§Ö‡§∏‡•ç‡§∏‡§≤‡§æ‡§Æ ‡§µ‡§æ‡§≤‡•á‡§ï‡•Å‡§Æ, ‡§Ø‡§π ‡§è‡§ï ‡§µ‡•â‡§Ø‡§∏ ‡§ü‡•á‡§∏‡•ç‡§ü ‡§π‡•à‡•§";
    if(voice.includes("en")) testText = "Hello, this is a voice test.";
    
    await generateAudio(testText, voice, true);
}

async function generate() {
    const text = document.getElementById("text").value.trim();
    const voice = document.getElementById("voice").value;
    if(!text){ alert("Please enter text!"); return; }
    if(text.length > 4000){ alert("Limit is 4000 chars!"); return; }
    
    await generateAudio(text, voice, false);
}

async function generateAudio(text, voice, isTest) {
    const rate = document.getElementById("rate").value;
    const pitch = document.getElementById("pitch").value;
    const baseUrl = apiInput.value.replace(/\/$/, "");
    const API_URL = baseUrl + "/tts";

    if(!isTest) {
        genBtn.disabled = true;
        genBtn.innerText = "Working...";
        statusBox.style.display = "block";
        statusBox.innerText = "‚è≥ Generating...";
        statusBox.style.color = "#ffd700";
        statusBox.style.background = "#334155";
        dlBtn.style.display = "none";
    }

    try {
        const res = await fetch(API_URL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ text, voice, rate, pitch })
        });

        if(!res.ok) {
            const err = await res.json();
            throw new Error(err.detail || err.error || "Failed");
        }

        audioBlob = await res.blob();
        const url = URL.createObjectURL(audioBlob);
        audioPlayer.src = url;
        audioPlayer.style.display = "block";
        
        if(!isTest) {
            dlBtn.style.display = "block";
            statusBox.style.display = "none";
        }

        try { await audioPlayer.play(); } catch(e){}

    } catch(e) {
        if(!isTest) {
            statusBox.innerText = "‚ùå Error: " + e.message;
            statusBox.style.color = "#ff4d4d";
            statusBox.style.background = "#450a0a";
        } else {
            alert("Voice Error: " + e.message);
        }
    } finally {
        if(!isTest) {
            genBtn.disabled = false;
            genBtn.innerHTML = '<span class="material-icons-round">multitrack_audio</span> Generate';
        }
    }
}

function stopAudio(){
    audioPlayer.pause();
    audioPlayer.currentTime = 0;
}

function download(){
    if(!audioBlob) return;
    const a = document.createElement("a");
    a.href = URL.createObjectURL(audioBlob);
    a.download = "voice-output.mp3";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
</script>

</body>
</html>
