<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hindi / Urdu Realistic TTS</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family: 'Segoe UI', sans-serif;
  background:#0f172a;
  color:#e2e8f0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}
header{
  padding:15px;
  text-align:center;
  font-size:1.2rem;
  font-weight:bold;
  background:#1e293b;
  border-bottom: 2px solid #38bdf8;
}
.container{
  padding:20px;
  max-width: 500px;
  margin: 0 auto;
  flex: 1;
}
label{
  display:block;
  margin:15px 0 5px;
  color: #38bdf8;
  font-size: 0.9rem;
}
input,textarea,select{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:1px solid #334155;
  background:#1e293b;
  color:#fff;
  font-size:1rem;
  outline: none;
}
textarea{min-height:100px; resize:vertical;}

.buttons{
  display:flex;
  gap:10px;
  margin-top:20px;
}
button{
  flex:1;
  padding:14px;
  border-radius:8px;
  border:none;
  font-size:1rem;
  font-weight:600;
  cursor: pointer;
}
button.primary{ background:#0ea5e9; color:#fff; }
button.secondary{ background:#334155; color:#cbd5e1; }
button:disabled{ opacity: 0.5; }

/* Status Box */
#status-box {
    margin-top: 15px;
    padding: 10px;
    background: #334155;
    border-radius: 6px;
    text-align: center;
    font-size: 0.9rem;
    display: none;
    color: #ffd700;
}

audio{
  width:100%;
  margin-top:20px;
  display: none;
}
.download-btn {
    background: #22c55e;
    color: white;
    width: 100%;
    margin-top: 15px;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    cursor: pointer;
    display: none;
}
</style>
</head>

<body>

<header>üéôÔ∏è Hindi TTS Studio</header>

<div class="container">

<label>API URL (Read Only)</label>
<input id="api-url" value="https://hindi-tts-3gjy.onrender.com" readonly style="opacity:0.6">

<label>Select Voice</label>
<select id="voice">
  <option value="hi-male">Hindi ‚Äì Male</option>
  <option value="hi-female">Hindi ‚Äì Female</option>
  <option value="ur-male">Urdu ‚Äì Male</option>
</select>

<label>Enter Text</label>
<textarea id="text">‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§Ø‡§π ‡§è‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ‡§π‡•à‡•§</textarea>

<div class="buttons">
  <button class="primary" id="genBtn" onclick="generate()">‚ñ∂ Generate</button>
  <button class="secondary" onclick="stopAudio()">Stop</button>
</div>

<div id="status-box">Processing...</div>

<audio id="player" controls></audio>
<button id="dlBtn" class="download-btn" onclick="download()">‚¨á Download Audio</button>

</div>

<script>
let audioBlob = null;
const audioPlayer = document.getElementById("player");
const genBtn = document.getElementById("genBtn");
const statusBox = document.getElementById("status-box");
const dlBtn = document.getElementById("dlBtn");

async function generate(){
  const text = document.getElementById("text").value.trim();
  const voice = document.getElementById("voice").value;
  // URL ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§∏‡•á ‡§∏‡•ç‡§≤‡•à‡§∂ ‡§π‡§ü‡§æ‡§è‡§Ç ‡§î‡§∞ /tts ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  const baseUrl = document.getElementById("api-url").value.replace(/\/$/, "");
  const API_URL = baseUrl + "/tts";

  if(!text){ alert("Text required!"); return; }

  // UI Reset
  genBtn.disabled = true;
  genBtn.innerText = "Wait...";
  statusBox.style.display = "block";
  statusBox.innerText = "Connecting to server...";
  statusBox.style.color = "#ffd700"; // yellow
  audioPlayer.style.display = "none";
  dlBtn.style.display = "none";

  try {
    const res = await fetch(API_URL, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ text: text, voice: voice })
    });

    // ‡§Ö‡§ó‡§∞ Error ‡§Ü‡§Ø‡§æ ‡§§‡•ã ‡§â‡§∏‡•á ‡§™‡§ï‡•ú‡•á‡§Ç
    if(!res.ok) {
        const errData = await res.json();
        throw new Error(errData.detail || "Server Error");
    }

    // Success
    audioBlob = await res.blob();
    const url = URL.createObjectURL(audioBlob);
    
    audioPlayer.src = url;
    audioPlayer.style.display = "block";
    dlBtn.style.display = "block";
    statusBox.style.display = "none";
    
    // Play automatically
    try { await audioPlayer.play(); } catch(e){}

  } catch(e) {
    console.error(e);
    statusBox.style.display = "block";
    statusBox.innerText = "‚ùå ERROR: " + e.message;
    statusBox.style.color = "#ff4d4d"; // red
    alert("Error: " + e.message);
  } finally {
    genBtn.disabled = false;
    genBtn.innerText = "‚ñ∂ Generate";
  }
}

function stopAudio(){
  audioPlayer.pause();
  audioPlayer.currentTime = 0;
}

function download(){
  if(!audioBlob) return;
  const a = document.createElement("a");
  a.href = URL.createObjectURL(audioBlob);
  a.download = "tts-audio.wav";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>

</body>
</html>
